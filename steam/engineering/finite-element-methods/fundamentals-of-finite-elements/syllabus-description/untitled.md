# index

FUNDAMENTALS OF FINITE ELEMENTS MANE.6660 AND CIVL.6660

Notes List

$\textcolor{red}{\texttt{THIS SHIT IS BROKEN\}}$

The class notes and handouts will be located in [https://www.scorec.rpi.edu/\~shephard/FEM/class-handouts-notes/](https://www.scorec.rpi.edu/~shephard/FEM/class-handouts-notes/)

Course introduction – August 30, 2019

* FEM Fund course info.pdf&#x20;
* Into-to-1D-second-order-pde.pdf

Chapter 1 material – September 6, 2019 through ???

* Appendix4.I.1.pdf&#x20;
* Equivalence of S and W.pdf&#x20;
* 1-2DOF-example.pdf
* MWR.pdf&#x20;
* MWR-example.pdf
* global-local.pdf

## Syllabus

FUNDAMENTALS OF FINITE ELEMENTS MANE.6660 AND CIVL.6660 • Class meets: Tuesday and Friday, 10-11:50, 212 Ricketts Building • Instructor: Prof. Mark S. Shephard, 4019 CII, shephard@rpi.edu, 276-8044. Scheduled office hours are Wednesday 12-1:30 and Thursday 8:00-9:30. Feel free to stop by with questions at other times. Call or email if you would like to set an appointment to be sure I will be there for a meeting. • Although this is a 3-credit course, we will use most of the lecture period. This will allow us to make up for classes missed due to travel. • Handouts and homework will be available at: [http://www.scorec.rpi.edu/\~shephard/FEM/](http://www.scorec.rpi.edu/~shephard/FEM/) File with running list of the files with class notes will be in [https://www.scorec.rpi.edu/\~shephard/FEM/notes-list.pdf](https://www.scorec.rpi.edu/~shephard/FEM/notes-list.pdf) Prerequisite: • Basic knowledge of continuum mechanics • Basic knowledge of numerical methods Grading: Homework 25% In class test 1 25% In class test 2 25% Term Project 25% Homework: Each homework set will include one or more problems designed to cover specific aspects of the course material. The problems to be graded from each assignment will be indicated on the handout. Each graded problem will be worth 10 points unless stated otherwise. You are expected to do all problems. Please turn in the assignments on time. Solutions to all problems will be on line at [http://www.scorec.rpi.edu/\~shephard/FEM/](http://www.scorec.rpi.edu/~shephard/FEM/). The policy for grading will be: 1. Full credit as long as the problem is turned in before grading of that problem set. 2. Partial credit for problems turned in at any time. However, the credit possible becomes quite low after the solutions are returned or are in the library. In class test: There will be two in class closed book tests during the semester. Specific dates will be determined later. Term Project: All students in the class are required to do a term project. There are a variety of project types to choose from. Details will be given in a separate handout. FUNDAMENTALS OF FINITE ELEMENTS MANE.6660 AND CIVL.6660 COURSE OUTLINE Text: Chapters from T.J.R. Hughes, The Finite Element Method: Linear Static and Dynamic Finite Element Analysis, Dover Pubns., ISBN 0486411818, 2000. OUTLINE 1. Basic Concepts of Finite Element Method for 1-D Problems (Chapter 1.) 1.1. Notation, and Elementary Continuity Considerations 1.2. Strong Form of the Boundary Value Problem 1.3. Derivation of the Weak Form 1.4. Galerkin Approximation 1.5. Derivation of the Matrix Form 2. Finite Element Method for 2-D Problems (Chapter 2.) 2.1 Notation and Mathematical Preliminaries 2.2 The Steady State Heat Conduction Problem 2.3 The Linear Elasticity Problem 3. Development of 2-D and 3-D Elements (Chapter 3., Notes) 3.1 Overview and Requirements for 2-D Elements 3.2 Triangular Elements via Triangular Coordinates 3.3 Rectangular Elements 3.4 Numerical Integration 3.5 Isoparametric Elements 4. Higher Order Finite Elements (Notes 4.1 Concepts of h-, p-, and hp-Finite Elements 4.2 Hierarchic Shape Functions Based on Legendre Polynomials 4.3 Isogeometric Finite Element 4.4 Mesh Representation and Integration of High Order Elements 5. Error Estimates (Parts of sections 4.1, 4.I, Notes) 5.1 Mathematical Preliminaries 5.2 A Priori Error Estimates 5.3 A Posteriori Error Estimates 6. Some additional topics covered in a lecture or two 6.1 Plate and Shell finite elements 6.2 Finite elements for fluid flow problems 6.3 Available finite element software (to be covered earlier in the semester) FINITE ELEMENT RESOURCES Finite Element Text Books (there are many more) T.J.R. Hughes, The Finite Element Method: Linear Static and Dynamic Finite Element Analysis, Dover Pubns., ISBN 0486411818, 2000. O.C. Zienkiewicz and R.L. Taylor, The Finite Element Method: Fourth Edition, Vol.1: Basic Formulations and Linear Problems, McGraw-Hill, 1989. O.C. Zienkiewicz and R.L. Taylor, The Finite Element Method: Fourth Edition, Vol.2: Solid and Fluid Dynamics and Non-linearity, McGraw-Hill, 1991. K.J. Bathe, Finite Element Procedures, Prentice Hall, 1996. B. Szabo and I. Babuska, Finite Element Analysis, Wiley, 1991. E.B. Becker, G.F. Carey and J.T. Oden, Finite Elements: An Introduction, Vol. 1, Prentice Hall, 1981. T. Belytschko, W.-K. Liu and B. Moran, “Nonlinear Finite Elements for Continua and Structures”, John Wiley & Sons, 2001. R.D. Cook, D.S. Malkus, M.E. Plesha and R.J. Witt, Concepts and Applications of Finite Element Analysis, 4th edition, John Wiley & Sons, 2002. M.A. Crisfield, Non-linear Finite Element Analysis of Solids and Structures, Wiley, 1991. J.N. Reddy, An Introduction to the Finite Element Method, 3rd edition, McGraw-Hill, 2006. J. Fish and T. Belytschko, “A First Course in Finite Elements”, John Wiley & Sons, 2007. Journals with FE Articles International Journal for Numerical Methods in Engineering Computer Methods in Applied Mechanics and Engineering International Journal for Numerical Methods in Fluids Finite Elements in Analysis and Design Computational Mechanics Engineering with Computers Computers & Structures International Journal of Numerical Methods for Heat & Fluid Flow International Journal for Numerical and Analytical Methods in Geomechanics Communications in Numerical Methods in Engineering Multiscale Computational Engineering FUNDAMENTALS OF FINITE ELEMENTS TERM PROJECTS Everyone enrolled is required to complete a term project. Projects can be selected from the list of possible project topics given below, or be selected by the student subject to approval. Projects can be done individually or in small groups. The due dates for project activities are: First Friday in October: Last date to select project topic. Submit a document indicating topic area, goal of efforts, and activities to be performed Second Tuesday in Nov.: Brief one to two page progress report due Last day of class: Final written report due Project topic areas - The list below are suggested topic areas, you are free to tailor a project area to your interest, or define entirely new project areas that are of specific interest to you. The primary goal of the project is to engage in an area of interest where you want further understanding. 1. State-of-the-art papers. This class of project entails a detailed literature survey into a topic area of interest. The project write-up should present a detailed summary of the most important techniques and compare them to each other. Some possible topics include: a) Stabilized finite element techniques b) Isogeometric finite element formulations c) Techniques to solve coupled solid/fluid problems d) Combination of finite element and atomic level simulations e) Finite element methods for chemical problems f) Finite element techniques for representing damage g) Stochastic Finite elements h) Finite element analysis of a particular class of evolving geometry problem i) Finite element procedures to solve the Navier-Stokes equations j) Finite element techniques for multiscale modeling k) Finite element based methods for multiphase flows 2. Analysis or program studies. These projects involve the use of programs or procedures to test a program and/or perform a set of analysis studies. In all cases the report will document the procedures used and the analyses run. In some cases simple programming to convert data may be required. Some possible projects include: a) Run a series of analyses comparing the relative merits of various element types, b) Run a set of medal forming studies, c) Run a series of composite shell problems, d) Run a series of fracture studies, e) Run a set of 3-D flow studies, f) Run a set of soft tissue studies, g) Run multiscale simulations. 3. Finite element programming projects. These projects involve a programming effort. In some cases you may be working with the researchers that developed the original program. Only attempt a programming project if you have programming experience. The grade will be based on the finite element aspects of the project, not how much you learned about editors, languages, etc. Some possible projects include: a) Adding a material routine or element type to a SCOREC or other code b) Implement aspects of multiscale simulation techniques c) Implementation of an advanced iterative equation solver d) Implement part of a p-version analysis code e) Implement an a posteriori error estimator g) Implement your own finite element code Comments - Do not wait until the last two weeks to try to do the entire project. The demands on library materials and computer resources will make your efforts less efficient. In addition you will tend to learn much less from a project done in a rush. Finally, the resulting project and grade are typically poorer. Fundamentals of Finite Elements Guidelines for Term Project Write-ups The report should be typewritten on one side of the page and double spaced. You should use a word processor. Hand-printed equations are acceptable when necessary. The report should contain, as a minimum, the following sections: 1) Title Page and Abstract 2) Introduction 3) One or more sections detailing the project including discussing the theory investigated, approaches evaluated and what was done with this information. 4) A section on project results in terms of what was learned, what the analyses indicated and/or what the program did. If your project was an analysis study, there may be more than one section on "results". Be sure those sections carefully document what was done and what they showed you about the capabilities of finite elements. 5) Concluding remarks 6) References 7) Appendix containing listing of the code written for project (if any) or other similar types of information. The abstract should be in the range of 100-250 words in length and delineate the important points of the report. The introduction should first define the problem and its significance, review briefly the existing knowledge about the problem and outline recent contributions in the literature relating to it, describe the general approach being taken in this report, and identify the sequence of sections in which the details of the work are to be described in the report. The sections detailing the project are often three in number. One section is often devoted to a description and development of the basic theoretical considerations related to the project. Another section may discuss the overall structure of the software developed and/or combined to attack the problem giving justification for these selections. The third section may present the detailed algorithms developed. The results section should summarize the capabilities developed and demonstrate them on example problems. The concluding remarks should not only summarize the success and failure of the work performed; it should clearly define what has been achieved and discuss what should be done in future work to fill in any important gaps. Reference to the existing literature is a critical part of the project write-up. They should be listed in a section entitled References at the end of the report. They should be listed using one of the standard methods of sighting references as used in technical journals.

### fem course info

### FEM Fund course info.pdf

### Into-to-1D-second-order-pde.pdf

## Chapter 1 material – September 6, 2019 through ???

### Appendix4.I.1.pdf

* Linear space: a collection of objects that satisfy the following: If u and v are members of a linear space and α and β are scalars, then αu + βv is also a member of that linear space.
* addition is component wise&#x20;

$$
\begin{array}{l}{\vec{u}+\vec{v}=\left(u_{1}, u_{2}, u_{3}, \dots u_{n}\right)+\left(v_{1}, v_{2}, v_{3}, \dots v_{n}\right)=} \\ {\left(u_{1}+v_{1}, u_{2}+v_{2}, u_{3}+v_{3}, \dots u_{n}+v_{n}\right)}\end{array}
$$

*   scalar multiplication is distributed

    $$
    \alpha \vec{u}=\left(\alpha u_{1}, \alpha u_{2}, \alpha u_{3}, \dots \alpha u_{n}\right)
    $$
*

$$
\alpha \vec{u}+\beta \vec{v}=\left(\alpha u_{1}+\beta v_{1}, \alpha u_{2}+\beta v_{2}, \alpha u_{3}+\beta v_{3}, \dots \alpha u_{n}+\beta v_{n}\right)
$$

> Linear spaces have very nice properties that make it easy for us to “prove” things will behave the way we would like. Thus we want to be sure to know when the contributions to our FE weak forms are members of linear spaces. (For this class they will be, as you get to more complex problems they may not be, then things you have to figure out what you can use. Key linear space properties we like to employ are inner products (like our integrals to be inner products) and norms (which will represent a measure of size).

*   Inner product

    $$
    \begin{array}{l}{\text { Definition: An inner product }\langle\cdot, \bullet\rangle \text { on a real linear }} \\ {\text { space } A \text { is a map }\langle\cdot ; A \times A \rightarrow \Re \text { with the following }} \\ {\text { properties: }} \\ {\text { i) }\langle u, v\rangle=\langle v, u\rangle \text { (symmetry) }} \\ {\text { ii) }\langle\alpha u, v\rangle=\alpha\langle u, v\rangle} \\ {\text { iii) }\langle\alpha u, v\rangle=\langle u, w\rangle+\langle v, w\rangle \quad \text { (ii) and iii) are linearity) }} \\ {\text { iv) }\langle u, u\rangle \geq 0 \text { and }\langle u, u\rangle= 0 \text { if and only if } u=0} \\ {\text { (positive definiteness) }}\end{array}
    $$

    * Note
    * $$
      \begin{array}{l}{\text { Definition: Let }\{A,\langle\cdot\rangle\} \text { be an inner produce space }} \\ {\text { (i.e., a linear space } A \text { with and inner product } \notin, \text { ' }} \\ {\text { defined on } A \text { . Then } u, v \in A \text { are said to be orthogonal }} \\ {\text { (with respect to }\langle\cdot \cdot\rangle) \text { if }\langle u, v\rangle= 0}\end{array}
      $$
*

$$
\langle u, v\rangle^{2} \leq\langle u, u\rangle\langle v, v\rangle
$$

* Norm on linear space is an operator with properties
  * SemiNorm is positive semidefinite: where the inner product with itself returns 0
  * Natural norm or a true norm $|u|=\langle u, u\rangle^{1 / 2}$
*   Sobolev Inner Product and Norm

    $$
    \begin{array}{l}{\text { Consider a domain } \Omega \subset \Re^{n_{\mu}}, n_{s_{d}} \geq 1 \text { (will be the spatial }} \\ {\text { dimension }-1 D, 2 D, 3 D), \text { and let } u, v : \Omega \rightarrow \Re}\end{array}

    \\

    \begin{array}{l}{\left.\text { The } L_{2}(\Omega) \text { (or equivalently } H^{o}(\Omega)\right) \text { inner product and }} \\ {\text { norm are defined by }} \\ {(u, v)=(u, v)_{0}=\int_{\Omega} u v d \Omega} \\ {\|u\|=(u, u)^{1 / 2}}\end{array}

    \\

    \begin{array}{l}{\text { The } H^{1}(\Omega) \text { inner product and norm are defined by }} \\ {(u, v)_{1}=\int_{\Omega}\left(u v+u_{, i} v_{, i}\right) d \Omega\left(\operatorname{sum} 1 \leq i \leq n_{s d}\right)} \\ {\|u\|=(u, u)_{1}^{1 / 2}}\end{array}
    $$

Note on Notation: follow index rules

Weighing function and trial functions have nice properties here

$$
\begin{array}{c}{u \in H^{0} \text { if } \int_{\Omega} u^{2} d \Omega<\infty} \\ {u \in H^{1} \text { if } \int_{\Omega}\left(u u+u_{, i} u_{, i}\right) d \Omega<\infty}\end{array}
$$

Recall that $f : \Omega \rightarrow \mathfrak{R}, \kappa \in \mathfrak{R}\$$$

$\in&#x74;_{0}^{1} w_{, x} \kappa u\_{, x} d x$it is clear that it will be well behaved for u and w in H1

we want weighting function to be in the space $V=\left{w\left|w \in H^{1}, w\right|_{\Gamma_{g\}}=0\right}$

which is the set of functions where the weight on the closure of the set is 0

trial space is similar but not homogenous bc $\boldsymbol{\delta}=\left{u\left|u \in H^{1}, u\right|_{\Gamma_{s\}}=g\right}$

$$
\begin{array}{l}{\text { Given had } f : \overline{\Omega} \rightarrow \Re, \kappa \in \Re, \kappa>0, \text { and constants } g} \\ {\text { and } h, \text { find } u \in \delta \text { such that for all } w \in V} \\ {\qquad a(w, u)=(w, f)+(w, h)_{\Gamma}} \\ {\text { for the problem we have thus far we have: }} \\ {a(w, u)=\int_{0}^{1} w_{x} \kappa u_{x} d x} \\ {(w, f)=\int_{0}^{1} w f d x} \\ {(w, h)_{\Gamma}=w(0) h} \\ {\text { We can check the symmetry and bilinearity of the }} \\ {a(w, u) \text { and }(w, f)}\end{array}
$$

### Equivalence of S and W.pdf

$$
\begin{array}{l}{\text { We want to demonstrate that: }} \\ {\cdot \text { If } u \text { is a solution to (S) it is a solution to (W) }} \\ {\bullet \text { If } u \text { is a solution to (W) it is a solution to (S) }} \\ {\bullet \text { The solution } u \text { is unique }} \\ {\text { For simplicity we will use } \kappa=1 \text { and the specific BCs }} \\ {u(1)=g \text { and }-u_{x}(0)=h}\end{array}
\\
\begin{array}{l}{\text { Given } u \text { is a solution to (S) we have }} \\ {\qquad \begin{aligned} \text { (S) } u_{, x x}+f=0 & \text { in } \Omega, u(1)=g \text { and }-u_{x}(0)=h \\ \text { Therefore we can write } \\ \qquad-\int_{0}^{1} w\left(u_{x x}+f\right) d x=0 & \forall w \in V(\forall \text { means "for all") }\\ \text { Integrate the first term by parts to get } \\ \qquad \int_{0}^{1} w_{x} u_{x} d x-\int_{0}^{1} w f d x-\left.w u_{x}\right|_{0} ^{1}=0 \forall w \in V \\ \text { note: } w(1)=0(w \in V), \text { and }-u_{x}(0)=h \\ \int_{0}^{1} w_{x} u_{x} d x=\int_{0}^{1} w f d x+w(0) h \forall w \in V \end{aligned}}\end{array}
$$

$$
\begin{array}{l}{\text { Given } u \text { is a solution to (S) we have }} \\ {\qquad \begin{aligned} \text { (S) } u_{, x x}+f=0 & \text { in } \Omega, u(1)=g \text { and }-u_{x}(0)=h \\ \text { Therefore we can write } \\ \qquad-\int_{0}^{1} w\left(u_{x x}+f\right) d x=0 & \forall w \in V(\forall \text { means "for all") }\\ \text { Integrate the first term by parts to get } \\ \qquad \int_{0}^{1} w_{x} u_{x} d x-\int_{0}^{1} w f d x-\left.w u_{x}\right|_{0} ^{1}=0 \forall w \in V \\ \text { note: } w(1)=0(w \in V), \text { and }-u_{x}(0)=h \\ \int_{0}^{1} w_{x} u_{x} d x=\int_{0}^{1} w f d x+w(0) h \forall w \in V \end{aligned}}\end{array}
$$

$$
\begin{array}{l}{\text { Given } u \text { is a solution to (W) we have } u \in \delta \text { (thus we }} \\ {\text { have already taken care of the essential BC } u(1)=g)} \\ {\text { (W) } \int_{0}^{1} w_{x} u_{x} d x=\int_{0}^{1} w f d x+w(0) h \forall w \in V} \\ {\text { Integrate the first by parts (go the other way) we get }} \\ {\quad \int_{0}^{1} w\left(u_{, x x}+f\right) d x-\left.w u_{x}\right|_{0} ^{1}+w(0) h=0 \forall w \in V}\end{array}
$$

$$
\begin{array}{l}{\text { note: } w(1)=0(w \in V) \text { so this reduces to }} \\ {\qquad \int_{0}^{1} w\left(u_{x x}+f\right) d x+w(0)\left(u_{x}(0)+h\right)=0 \forall w \in V \text { eq. A }} \\ {\text { note that this says the sum of two things has to be }} \\ {\text { zero but we need to still show that the two pieces of }} \\ {u_{x x}+f=0 \text { and }-u_{x}(0)=h \text { are set. Since we need to }} \\ {\text { meet eq. A } \forall w \in V \text { we can select specific ones that }} \\ {\text { let us see one piece of the equation at a time. }}\end{array}
$$

$$
\begin{array}{l}{\text { Select } w=\phi\left(u_{x x}+f\right) \text { where } \phi \text { is a smooth positive }} \\ {\text { function that is } 0 \text { at both ends }(\phi(x)>0,0<x<1 \text { and }} \\ {\phi(0)=\phi(1)=0) \text { ). With that eq. A becomes }} \\ {\quad \int_{0}^{1} \phi\left(u_{x, x}+f\right)^{2} d x+0(u(0)+h)=0} \\ {\text { With } \phi(x)>0 \text { in the domain with }\left(u_{x x}+f\right)^{2} \geq 0 \text { for }} \\ {0<x<1 \text { we have no option but to have }} \\ {\left(u_{x x}+f\right)^{2}=0 \text { for } 0<x<1 \text { which is the domain } \Omega} \\ {\text { With this eq. A is }} \\ {\text { since } \forall w \in V \text { puts no restriction on } w(0) \text { then }} \\ {\text { And we are done. }}\end{array}
$$

$$
\begin{array}{l}{\text { To show the solution is unique go from weak form }} \\ {\text { Given } \ldots \text { , find } u \in \delta \text { such that } \forall w \in V} \\ {\qquad \begin{array}{l}{a(w, u)=(w, f)+(w, h)_{\Gamma}} \\ {\text { Lets assume two solutions, } u 1 \text { and } u 2 \text { (will show it is }} \\ {\text { not possible). Then }} \\ {\qquad a(w, u 1)=(w, f)+(w, h)_{\Gamma} \text { eq. } B} \\ {\qquad a(w, u 2)=(w, f)+(w, h)_{\Gamma} \quad \text { eq. } C} \\ {\qquad a(w, u 1)-a(w, u 2)=0}\end{array}}\end{array}
$$

a

$$
\begin{array}{l}{\text { which by bi-linearity is }} \\ {\qquad \begin{aligned} a(w,(u 1-u 2)) &=0 \\ \text { select } w=u 1-u 2 & \text { note } w \in V \text { giving us } \\ \qquad a((u 1-u 2),(u 1-u 2))=0 \\ \text { By the requirement of positive definiteness of } a\left(\bullet,^{\circ}\right) \\ \text { the only way we can have meet this is for } \\ u 1-u 2=0 \text { or } u 1=u 2 \\ \text { thus the solution is unique. } \end{aligned}}\end{array}
$$

We are now ready to go the next step – going from the infinite dimensional case of the exact solution to what will ultimately lead to the desired finite element form. For our finite dimensional finite element form we typically use a superscript h

$$
\begin{array}{l}{\text { For the exact solution we have infinite dimensional }} \\ {\text { spaces } V \text { and } \delta \text { . We define finite dimensional spaces }} \\ {\qquad V^{h} \subset V \text { and } \delta^{h} \subset \delta} \\ {\text { from which take finite dimensional } w^{h} \text { and } u^{h}} \\ {w^{h} \in V^{h} \text { and } u^{h} \in \delta^{h}}\end{array}
$$

a

$$
\begin{array}{l}{\text { recalling that spaces } V \text { and } \delta\left(\text { and thus } V^{h} \text { and } \delta^{h}\right)} \\ {\text { differ by only by how they deal with the essential }} \\ {\text { boundary conditions, and the fact that linear spaces }} \\ {\text { have properties we like, we will decompose } u^{h} \text { into }} \\ {u^{h}=v^{h}+g^{h} \text { where } v^{h} \in V^{h} \text { and } g^{h} \in \delta^{h}} \\ {\text { that is } g^{h} \text { will satisfy the essential BC and } v^{h} \text { will }} \\ {\text { satisfy the homogeneous version of the BC (ie. are 0) }}\end{array}
$$

$$
\begin{array}{l}{\text { We will select to use the same form for } w^{h} \text { and } v^{h}} \\ {\text { which will be to define } V^{h} \text { as a linear combination of } n} \\ {\text { given functions } N_{A} : \Omega \rightarrow \Re A=1(1) n \text { (A starts at } 1 \text { and }} \\ {\text { goes to n by increments of } 1 \text { ). With this }}\end{array}
$$

then

$$
w^{h}=C_{A} N_{A}=\sum_{A=1}^{n} C_{A} N_{A}=C_{1} N_{1}+C_{2} N_{2}+C_{3} N_{3}+\ldots+C_{n} N_{n}\\
v^{h}=d_{A} N_{A}
$$

a

$$
\begin{array}{l}{\text { where } m \text { is the number of shape functions need to }} \\ {\text { cover the essential BC. For the text example } m=1} \\ {\qquad u^{h}=v^{h}+g^{h}=\sum_{1}^{n} d_{A} N_{A}+g N_{n+1}}\end{array}
$$

a

$$
\begin{array}{l}{\text { Substituting into abstract form and using bi-linearity, }} \\ {\text { which says } a(w,(v+g))=a(w, v)+a(w, g), \text { we have }} \\ {\qquad a(w, v)=(w, f)+(w, h)_{\Gamma}-a(w, g)} \\ {\text { Putting in the summations we have }} \\ {\qquad a\left(\sum_{A=1}^{n} C_{A} N_{A}, \sum_{B=1}^{n} d_{B} N_{B}\right)=\left(\sum_{1}^{n} C_{A} N_{A}, f\right)+\left(\sum_{1}^{n} C_{A} N_{A}, h\right)_{\mathrm{r}}} \\ {\quad-a\left(\sum_{A=1}^{n} C_{A} N_{A}, \sum_{B=n+1}^{n+1} g_{B} N_{B}\right) \text { eq.D }}\end{array}
$$

a

$$
\begin{array}{l}{\text { note } a\left(\sum_{k=1}^{n} w_{n}, v\right)=\sum_{k=1}^{n} a\left(w_{d}, v\right)} \\ {a\left(\sum_{k=1}^{n} w_{n}, \sum_{k=1}^{n_{n}}\right)=\sum_{k=1}^{n} \sum_{a}^{a}\left(w_{n}, v_{s}\right) \text { thus eq. Dis }} \\ {\quad \quad \sum_{n=1}^{n} \sum_{k=1}^{n}\left(C_{1} N_{d}, d_{s} N_{s}\right)=\sum_{n=1}^{n} \sum_{n=n}^{n-n} a\left(C_{A} N_{n}, g_{s} N_{s}\right)} \\ {\text { Note that all terms have } \sum_{d=1}^{n} \text { which can pulled out }}\end{array}
$$

a

$$
\sum_{A=1}^{n} C_{A}\left[\sum_{B=1}^{n} a\left(N_{A}, N_{B}\right) d_{B}-\left(N_{A}, f\right)-\left(N_{A}, h\right)_{\Gamma}+\sum_{B=n+1}^{n+m} a\left(N_{A}, N_{B}\right) g_{B}\right]=0
$$

Lets define everything in the \[ ] as GA then we have

$$
\sum_{i=1}^{n} C_{A} G_{A}=0
$$

$$
\begin{array}{l}{\text { The only way to ensure this is that } G_{A}=0, A=1(1) n} \\ {\text { This gives us our finite element system, which is: }} \\ {\sum_{B=1}^{n} a\left(N_{A}, N_{B}\right) d_{B}=\left(N_{A}, f\right)+\left(N_{A}, h\right)_{\Gamma}-\sum_{b=n+1}^{n+m} a\left(N_{A}, N_{B}\right) g_{B} \text { eq. } E} \\ {\qquad A=1(1) n}\end{array}
$$

for the textbook case, this is:

$$
\begin{array}{r}{\sum_{B=1}^{n} a\left(N_{A}, N_{B}\right) d_{B}=\left(N_{A}, f\right)+N_{A}(0), h-a\left(N_{A}, N_{n+1}\right) g} \\ {A=1(1) n}\end{array}
$$

a

$$
\begin{array}{l}{\text { Define } K_{A B}=a\left(N_{A}, N_{B}\right)} \\ {\qquad F_{A}=\left(N_{A}, f\right)+\left(N_{A}, h\right)_{\Gamma}-\sum_{B=1}^{n+m} a\left(N_{A}, N_{B}\right) g_{B}}\end{array}\\
\begin{array}{l}{\text { Using these in eq. E we have }} \\ {\qquad \sum_{s=1}^{n} K_{A B} d_{B}=F_{A}, A=1(1) n} \\ {\text { Which is } n \text { equations in } n \text { unknowns or if you will is }} \\ {\text { and we have our } \mathrm{FE} \text { all the way to matrix algebra. }} \\ {\text { In summary we have done (S) } \$(\mathrm{W}) \approx(\mathrm{G}) \Rightarrow(\mathrm{M})}\end{array}
$$

### 1-2DOF-example.pdf

Stiffness Matrix

### MWR.pdf

### MWR-example.pdf

### global-local.pdf
